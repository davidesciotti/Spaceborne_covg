# options for the 3x2pt Gaussian covariance matrix computation
# Author: Davide Sciotti

zbins: 10 # number of redshift bins
zbins_use: 6
EP_or_ED: "EP" # or 'ED'. Equipopulated or equidistant redshift bins

ell_min: 10 # minimum ell for the angular power spectra
ell_max: 5000 # maximum ell for the angular power spectra
ell_bins: 32 # number of ell bins for the angular power spectra

# alternatively, one can specify the ell grid directly (set to "null" if you prefer to use ell_min, ell_max, ell_bins)
# ell_path: '../input/ell_values.txt'  # path to txt file with the ell grid
# delta_ell_path: '../input/delta_ell_values.txt' # path to txt file with the delta ell grid
ell_path: null
delta_ell_path: null

n_gal_shear:
  30 # number of sources per arcmin^2, relevant for weak lensing cosmic shear.
  # This scalar must be provided for equipopulated ('EP') redshift bins
n_gal_clustering:
  30 # number of lenses per arcmin^2, relevant for photometric galaxy clustering.
  # This scalar must be provided for equipopulated ('EP') redshift bins
n_gal_path_shear:
  null # path to .txt/.dat file with the number of sources per arcmin^2 *for each redshift bin*,
  # relevant for weak lensing cosmic shear. This must be provided for equidistant ('ED') redshift bins.
n_gal_path_clustering:
  null # path to .txt/.dat file with the number of lenses per arcmin^2 *for each redshift bin*,
  # relevant for photometric galaxy clustering. This must be provided for equidistant ('ED') redshift bins.

# path to txt file with the number of galaxies per arcmin^2 for each redshift bin. #  This must be provided for
# equidistant ('ED') redshift bins.
# n_gal_path: '../input/n_gal.txt'
n_gal_path: null

# intrinsic ellipticity dispersion per *component*. The total dispersion is
# sigma_eps = sigma_eps_i * sqrt(2), and the term entering the covariance is sigma_eps^2
sigma_eps_i: 0.26
# survey_area_deg2: 14700 # in deg^2
survey_area_deg2: 2500  # in deg^2
# survey_area_deg2: 41252.96125  # in deg^2
nside: 512
apodize_mask: True
aposize: 0.1 # apodization scale in deg
ells_per_band: 50 # number of multipole values per bandpower
nreal: 20
load_simulated_cls: False  # whether to load simulated cls from file
coupled: False  # compute the covariance of the coupled or uncoupled cls
which_ell_weights: get_weight_list()  # get_weight_list() or get_bandpower_windows()
which_cls: namaster  # namaster or healpy
compute_namaster_sims: False
use_INKA: False

# datavector and covariance ordering options
triu_tril: "triu" # or 'tril'. Which elements of the (symmetric) auto-spectra are kept
row_col_major: "row-major" # whether the flattening of the spectra is in row-major or column-major order
covariance_ordering_2D: "probe_zpair_ell" # must be one of ['probe_ell_zpair', 'probe_zpair_ell', 'ell_probe_zpair', 'zpair_probe_ell']
# the naming convention is to have the outermost loop on the left, and the innermost loop on the right; so, e.g.,
# probe_ell_zpair means that the outermost loop is on the probes, the middle loop is on ell and the innermost loop is on zpair
# CLOE v1 needs as input the ell_probe_zpair ordering.
# CLOE v2 needs as input the probe_ell_zpair ordering.
plot_covariance_2D: False # whether to plot (the log10 of) the 2D covariance matrix

# path to 3d numpy Cls. If part_sky is True, it has to be the unbinned Cl's from ell_min = 0 to ell_max = 3*NSIDE (or 2*NSIDE, to check)
cl_LL_3D_path: "{ROOT:s}/Spaceborne_covg/input/Cl_LL_unbinned_dav_C01.npy"
cl_GL_3D_path: "{ROOT:s}/Spaceborne_covg/input/Cl_GL_unbinned_dav_C01.npy"
cl_GG_3D_path: "{ROOT:s}/Spaceborne_covg/input/Cl_GG_unbinned_dav_C01.npy"

# Pseudo-Cl covariance
# If False will compute the full-sky covariance (divided by fsky).
# Else, compute the Pseudo-Cls covariance with NaMaster.
part_sky: True

# path to NaMaster workspace
workspace_path: "{ROOT:s}/Spaceborne_covg/input/fullsky_NmtWorkspace_NS32_LMIN10_BW5.fits"

# path to mask
read_mask: False  # True or False. if False, generates polar cap with desired sky area and nside on-the-fly
# DR3-like
# mask_path: /home/davide/Documenti/Lavoro/Programmi/CSSTforecasts/mask_nside4096/map_area_only.npy
# DR1-like (actual Euclid mask)
mask_path: /home/cosmo/davide.sciotti/data/common_data/mask/Redmine/rsd2024a-time-tagged-footprint-gal-12.fits

output_folder: "../output"
